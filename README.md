# Local-Media-Website-Network-Flows

## Data Directory Structure

The data is stored in structured directories within the general base directory named `data`. This directory is divided into subdirectories as follows:

- **raw**: This directory contains the original raw data, which is unprocessed and is further divided into:

    - *media*: where the table containing the list of all media and their data is stored.
    - *traffic*: where the .pcapng files from traffic monitoring are stored, grouped by the respective monitoring day. (Files were not uploaded due to their substantial size)

- **processed**: This directory contains cleaned, transformed, processed, or generated data derived from the raw data and is ready for use. These data are placed in the following subdirectories:

    - *datasets*: where the versions of datasets for each day are stored. The converted packet data from the respective day is aggregated and stored in a single file for that day. Additionally, the final dataset generated by combining the datasets from each day is also stored here.
    - *media*: where processed lists of media pages with additional traffic data are stored, filtered for accessibility.
    - *traffic*: where the converted packet data from .pcapng to CSV format is stored, grouped by the respective monitoring day.

## Data Processing

All the collected data, as explained above, are stored in the .pcapng format. Therefore, conversion and processing of such data are necessary. Initially, packets need to be classified based on their characteristics and grouped into flows, and then flow data should be represented in the .csv format, which is acceptable as input for future models.

The collected exchanged packet data, saved in the .pcapng format, cannot be directly used for further analysis. Therefore, they need to be converted and processed. The data processing steps are as follows:

- For each recorded visit in the .pcapng format, extract the packets belonging to that visit.
- Classify the packets based on their characteristics and group them into separate flows.
- Convert the data into the Excel format.
- Label each extracted flow based on the visited page.
- Associate the visit with the extracted flows, which are then saved in the CSV format.
- Create a new dataset that aligns with the structure of visits represented by flow data, combining all previously extracted flows.

An example of the structure of the final dataset generated after completing all the above steps is presented in Table \ref{tbl:dataset}.

```markdown
| Flow duration       | Fwd packets | Bwd packets | Length of fwd packets | Length of bwd packets | Flow bytes | Flow packets | Average packet size |
|---------------------|-------------|-------------|-----------------------|-----------------------|------------|--------------|---------------------|
| ...                 | ...         | ...         | ...                   | ...                   | ...        | ...          | ...                 |
```

The dataset includes the following fields:

- **FLOW_ID**: A string that identifies the flow.
- **SOURCE_IP**: The source IP address.
- **SOURCE_PORT**: The source port.
- **DESTINATION_IP**: The destination IP address.
- **DESTINATION_PORT**: The destination port.
- **PROTOCOL**: The transmission protocol (TCP, UDP, etc.).
- **TIMESTAMP**: The timestamp of the first packet in the flow.
- **LABEL**: The name of the browsed page, extracted from the filename.
- **FLOW_DURATION**: The duration of the flow in seconds.
- **TOTAL_FWD_PACKETS**: The total number of packets in the forward direction.
- **TOTAL_BACKWARD_PACKETS**: The total number of packets in the backward direction.
- **TOTAL_LENGTH_OF_FWD_PACKETS**: The total length of packets in the forward direction.
- **TOTAL_LENGTH_OF_BWD_PACKETS**: The total length of packets in the backward direction.
- **FLOW_BYTES_S**: The flow speed measured in bytes per second.
- **FLOW_PACKETS_S**: The flow speed measured in packets per second.
- **AVERAGE_PACKET_SIZE**: The average size of packets.

